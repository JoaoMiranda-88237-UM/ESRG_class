<<<<<<< HEAD
# ERSG_class - Group menseger
This project implements a "Broadcasting Chat service", using some features such as:
* TCP-IP Client/Server; 
* Posix threads;
* Message Queues;
* Daemons;
* Device Drivers.

## How it works?

Each Client is connected to the Server via TCP/IP. After the connection is established, each client can send to the server a character string passed by argument via command line. The server after receiving the message, it forwards the received messages to all connected Clients, and identifies the client that has sent the message. In order to check the status of each connected client. Every 5 seconds the Server checks if each client is still ONLINE or AFK. (it is not shown on the terminal).

#### Interconnection

![plot](./Interconnectio.png)

## How to use?
### 1. Installation

### 2. Execution 
#### 2.1 Start TCP server
Starts a TCP server on a given port.
```Shell
$ ./server <port>
```
#### 2.2 Start Daemon client
Starts a TCP client connected to a given server name on a given port.
```Shell
$ ./daemon <servername> <port> 
```
When this is running, a led (led0 - green led in Raspberry Pi) is light up. This is done via a device driver, developed in previous classes.
#### 2.3 Client - Send message / see received messages
Send message to server or to see messages that have been send to the client since last time. Everytime the user wants to send a message he must use client with the wanted message to be sent. 
```shell
$ ./client <msg[0}> <msg[1}> ... <msg[n]>
```
#### 2.4. Close connection
##### 2.4.1 On client
Type 'close', or use Ctrl+C.
```shell
$ ./tcpclient_send close
```
When this happens, the daemon terminates, and the led that was previously light up (led0) is turned off.

##### 2.4.2  On server
Type 'close', or use Ctrl+C.

## Done by
João Miranda, a88237
Duarte Rodrigues, a88259
Masters in Embedded Systems @ Universidade do Minho, 2021
=======
# ESRG_class
 * Execute MAKEFILE {make all}
    
    - CC_h - Compile to host
    - CC_r - Compile to rasp (change directory)
    - IP - change IP according information in ifconfig
         
 * Start TCP Server:
./tcpserver2.elf "port" 

 * Open TCP Client Daemon connection:
./daemon "Ip con""port"
 
 * Open TCP Client connection:
./client "message"
-> "message" is optional. (Without it just print last messages.)

 **Connection scheme:
 [SERVER]<---|TCP|---->[DEAMON CLIENT]<---|MESSAGE QUEUES|-->[CLIENT]**
 
 * Options available:

    [TCP - MESSAGE QUEUES]
    -Send a message to client:
        In client: ./client "print message"

    [MESSAGE QUEUES - TCP]    
    -Send a message to server and reply to others clients://
        In client: ./client "print message"

    -Kill server://
        In server: "close" or "cntrl+c"

    -Kill client connection://
        In client: ./client "close"

    [TCP]
    -5s to 5s server check state of client:
        Message: "STATE?"
        Daemon reply with state.
        (dont show on terminal)

    -1min to 1min after send a message the daemon client change the state to AFK if it don't sent a message;
        (don't show on terminal)

    [DEVICE DRIVERS]
    -When client start (daemon), the raspberry pi 4 led on

    -When client "close" connection, the raspberry pi 4 led off
    
## Done by
João Miranda, a88237


Duarte Rodrigues, a88259

Masters in Embedded Systems @ Universidade do Minho, 2021
>>>>>>> 1df48b5031552e6dd7f2444e7084ed16c680c264
